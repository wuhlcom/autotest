1、开启IP带宽控制，设置总带宽为1000kbps
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:ping
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:arp_clear

正在 Ping 10.10.10.57 具有 32 字节的数据:
来自 10.10.10.57 的回复: 字节=32 时间<1ms TTL=63
来自 10.10.10.57 的回复: 字节=32 时间=1ms TTL=63
来自 10.10.10.57 的回复: 字节=32 时间<1ms TTL=63
来自 10.10.10.57 的回复: 字节=32 时间=1ms TTL=63
来自 10.10.10.57 的回复: 字节=32 时间=1ms TTL=63

10.10.10.57 的 Ping 统计信息:
    数据包: 已发送 = 5，已接收 = 5，丢失 = 0 (0% 丢失)，
往返行程的估计时间(以毫秒为单位):
    最短 = 0ms，最长 = 1ms，平均 = 0ms
wifi ssid: WIFI_762009,passwd:12345678
wlan pc mac:14:75:90:F8:A2:2C
wlan pc ip:192.168.100.101
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:ipconfig

Windows IP 配置

   主机名  . . . . . . . . . . . . . : 知路测试sdgsdgkdsejkfjgkklj-wjekljsdskljf3sdg3
   主 DNS 后缀 . . . . . . . . . . . : 
   节点类型  . . . . . . . . . . . . : 混合
   IP 路由已启用 . . . . . . . . . . : 否
   WINS 代理已启用 . . . . . . . . . : 否

以太网适配器 AP:

   连接特定的 DNS 后缀 . . . . . . . : 
   描述. . . . . . . . . . . . . . . : Realtek USB FE Family Controller
   物理地址. . . . . . . . . . . . . : 00-E0-4C-36-14-02
   DHCP 已启用 . . . . . . . . . . . : 否
   自动配置已启用. . . . . . . . . . : 是
   本地链接 IPv6 地址. . . . . . . . : fe80::ec6d:f574:7481:635b%21(首选) 
   IPv4 地址 . . . . . . . . . . . . : 192.168.50.100(首选) 
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . : 
   DHCPv6 IAID . . . . . . . . . . . : 503373900
   DHCPv6 客户端 DUID  . . . . . . . : 00-01-00-01-1C-21-93-0A-BC-EE-7B-75-EB-4F
   DNS 服务器  . . . . . . . . . . . : fec0:0:0:ffff::1%1
                                       fec0:0:0:ffff::2%1
                                       fec0:0:0:ffff::3%1
   TCPIP 上的 NetBIOS  . . . . . . . : 已启用

以太网适配器 control:

   连接特定的 DNS 后缀 . . . . . . . : 
   描述. . . . . . . . . . . . . . . : Realtek PCIe GBE Family Controller #2
   物理地址. . . . . . . . . . . . . : 20-F4-1B-60-51-F5
   DHCP 已启用 . . . . . . . . . . . : 否
   自动配置已启用. . . . . . . . . . : 是
   本地链接 IPv6 地址. . . . . . . . : fe80::dd6:5d32:f850:8252%19(首选) 
   IPv4 地址 . . . . . . . . . . . . : 50.50.50.50(首选) 
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . : 
   DHCPv6 IAID . . . . . . . . . . . : 455144475
   DHCPv6 客户端 DUID  . . . . . . . : 00-01-00-01-1C-21-93-0A-BC-EE-7B-75-EB-4F
   DNS 服务器  . . . . . . . . . . . : fec0:0:0:ffff::1%1
                                       fec0:0:0:ffff::2%1
                                       fec0:0:0:ffff::3%1
   TCPIP 上的 NetBIOS  . . . . . . . : 已启用

以太网适配器 dut:

   连接特定的 DNS 后缀 . . . . . . . : 
   描述. . . . . . . . . . . . . . . : Realtek PCIe GBE Family Controller
   物理地址. . . . . . . . . . . . . : BC-EE-7B-75-EB-4F
   DHCP 已启用 . . . . . . . . . . . : 是
   自动配置已启用. . . . . . . . . . : 是
   本地链接 IPv6 地址. . . . . . . . : fe80::c819:87cf:3504:296e%18(首选) 
   IPv4 地址 . . . . . . . . . . . . : 192.168.100.100(首选) 
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   获得租约的时间  . . . . . . . . . : 2016年2月27日 12:07:25
   租约过期的时间  . . . . . . . . . : 2016年2月28日 0:07:25
   默认网关. . . . . . . . . . . . . : 192.168.100.1
   DHCP 服务器 . . . . . . . . . . . : 192.168.100.1
   DHCPv6 IAID . . . . . . . . . . . : 633138811
   DHCPv6 客户端 DUID  . . . . . . . : 00-01-00-01-1C-21-93-0A-BC-EE-7B-75-EB-4F
   DNS 服务器  . . . . . . . . . . . : 192.168.100.1
   TCPIP 上的 NetBIOS  . . . . . . . : 已启用

隧道适配器 Teredo Tunneling Pseudo-Interface:

   媒体状态  . . . . . . . . . . . . : 媒体已断开
   连接特定的 DNS 后缀 . . . . . . . : 
   描述. . . . . . . . . . . . . . . : Teredo Tunneling Pseudo-Interface
   物理地址. . . . . . . . . . . . . : 00-00-00-00-00-00-00-E0
   DHCP 已启用 . . . . . . . . . . . : 否
   自动配置已启用. . . . . . . . . . : 是

隧道适配器 isatap.{248CF58B-BF93-45FC-9050-F7163BF8C880}:

   媒体状态  . . . . . . . . . . . . : 媒体已断开
   连接特定的 DNS 后缀 . . . . . . . : 
   描述. . . . . . . . . . . . . . . : Microsoft ISATAP Adapter #2
   物理地址. . . . . . . . . . . . . : 00-00-00-00-00-00-00-E0
   DHCP 已启用 . . . . . . . . . . . : 否
   自动配置已启用. . . . . . . . . . : 是

隧道适配器 isatap.{8BAC9A05-919D-4C1B-ADC5-0DAC27A19740}:

   媒体状态  . . . . . . . . . . . . : 媒体已断开
   连接特定的 DNS 后缀 . . . . . . . : 
   描述. . . . . . . . . . . . . . . : Microsoft ISATAP Adapter #3
   物理地址. . . . . . . . . . . . . : 00-00-00-00-00-00-00-E0
   DHCP 已启用 . . . . . . . . . . . : 否
   自动配置已启用. . . . . . . . . . : 是

隧道适配器 6TO4 Adapter:

   连接特定的 DNS 后缀 . . . . . . . : 
   描述. . . . . . . . . . . . . . . : Microsoft 6to4 Adapter
   物理地址. . . . . . . . . . . . . : 00-00-00-00-00-00-00-E0
   DHCP 已启用 . . . . . . . . . . . : 否
   自动配置已启用. . . . . . . . . . : 是
   IPv6 地址 . . . . . . . . . . . . : 2002:3232:3232::3232:3232(首选) 
   默认网关. . . . . . . . . . . . . : 
   DNS 服务器  . . . . . . . . . . . : fec0:0:0:ffff::1%1
                                       fec0:0:0:ffff::2%1
                                       fec0:0:0:ffff::3%1
   TCPIP 上的 NetBIOS  . . . . . . . : 已禁用

隧道适配器 isatap.{41FBDD5C-1EE7-4C75-ADEB-174E80C7EBC5}:

   媒体状态  . . . . . . . . . . . . : 媒体已断开
   连接特定的 DNS 后缀 . . . . . . . : 
   描述. . . . . . . . . . . . . . . : Microsoft ISATAP Adapter #7
   物理地址. . . . . . . . . . . . . : 00-00-00-00-00-00-00-E0
   DHCP 已启用 . . . . . . . . . . . : 否
   自动配置已启用. . . . . . . . . . : 是
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:parse_ipconfig
pc mac:BC:EE:7B:75:EB:4F
pc ip:192.168.100.100
2、假设当前AP的地址为192.168.100.1。开启规则1和规则2，规则1IP地址为192.168.100.100，类型为保障最小带宽，带宽为800kbps；规则2IP地址为192.168.100.101，类型为受限最大带宽，带宽为800kbps
3、PC1的地址为192.168.100.100，PC2的地址为192.168.100.101,配置QOS规则
4、重启路由器
Waitfing for system reboot....
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:login_no_default_ip
5、PC1进行FTP下载，查看下载速率为多少
sleep 90 second for ftp download...
=============wired client capture first time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:tshark_duration
=============wired client capture second time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:tshark_duration
=============wired client capture three time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:tshark_duration
=============Statistics wired bandwith first time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:capinfos_all
File name:           D:/ftpcaps/ftp_wired_reboot1_00001_20160227135017.pcapng
File type:           Wireshark/... - pcapng
File encapsulation:  Ethernet
Packet size limit:   file hdr: (not set)
Number of packets:   830 
File size:           1282 kB
Data size:           1254 kB
Capture duration:    10 seconds
Start time:          Sat Feb 27 13:50:17 2016
End time:            Sat Feb 27 13:50:27 2016
Data byte rate:      125 kBps
Data bit rate:       1001 kbps
Average packet size: 1511.23 bytes
Average packet rate: 82 packets/sec
SHA1:                49019c2e13144a97b56b3fe808b38fd869d32b32
RIPEMD160:           53b31e50663110e8a43eead3c82083b4e0d1865f
MD5:                 00440f5d17b75c3b392236f925e04ce3
Strict time order:   True
有线客户端实际下载速率为1001000bps
有线客户端实际下载与受限最大带宽的差为:181800bps
=============Statistics wired bandwith second time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:capinfos_all
File name:           D:/ftpcaps/ftp_wired_reboot2_00001_20160227135038.pcapng
File type:           Wireshark/... - pcapng
File encapsulation:  Ethernet
Packet size limit:   file hdr: (not set)
Number of packets:   833 
File size:           1287 kB
Data size:           1258 kB
Capture duration:    10 seconds
Start time:          Sat Feb 27 13:50:38 2016
End time:            Sat Feb 27 13:50:48 2016
Data byte rate:      125 kBps
Data bit rate:       1001 kbps
Average packet size: 1511.29 bytes
Average packet rate: 82 packets/sec
SHA1:                43de186d5ea931f6ad8b8430502a34977b22e5c7
RIPEMD160:           53a6b5cb5e9011968a2d8a984514f45d063313ba
MD5:                 880b70927ad1c59d564393d412fcc4d3
Strict time order:   True
有线客户端实际下载速率为1001000bps
有线客户端实际下载与受限最大带宽的差为:181800bps
=============Statistics wired bandwith third time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:capinfos_all
File name:           D:/ftpcaps/ftp_wired_reboot3_00001_20160227135059.pcapng
File type:           Wireshark/... - pcapng
File encapsulation:  Ethernet
Packet size limit:   file hdr: (not set)
Number of packets:   827 
File size:           1277 kB
Data size:           1248 kB
Capture duration:    10 seconds
Start time:          Sat Feb 27 13:50:59 2016
End time:            Sat Feb 27 13:51:09 2016
Data byte rate:      125 kBps
Data bit rate:       1000 kbps
Average packet size: 1509.89 bytes
Average packet rate: 82 packets/sec
SHA1:                5737e0d3bf058b0f0fd48f201de22e81153db205
RIPEMD160:           a782972f09e91a86046b50226bd3f2a2e245c56a
MD5:                 6593d833de4987ce8f51b23cb2ec1c66
Strict time order:   True
有线客户端实际下载速率为1000000bps
有线客户端实际下载与受限最大带宽的差为:180800bps
6、PC2进行FTP下载，再查看此时PC1和PC2的下载速率各是多少
wireless can use  204800bps
sleep 120 seconds for download ...
=============wireless client capture first time=================
=============wireless client capture second time=================
=============wireless client capture three time=================
=============Statistics wireless bandwith first time=================
有线客户端的同时，无线客户端进行下载，其实际下载速率为314000bps
无线客户端实际下载速率与剩余带宽的差为:0.533203125bps
=============Statistics wireless bandwith second time=================
有线客户端的同时，无线客户端进行下载，其实际下载速率为321000bps
无线客户端实际下载速率与剩余带宽的差为:0.5673828125bps
=============Statistics wireless bandwith three time=================
有线客户端的同时，无线客户端进行下载，其实际下载速率为322000bps
无线客户端实际下载速率与剩余带宽的差为:0.572265625bps
=============wired client capture first time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:tshark_duration
=============wired client capture second time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:tshark_duration
=============wired client capture three time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:tshark_duration
=============Statistics wired bandwith fourth time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:capinfos_all
File name:           D:/ftpcaps/ftp_wired_reboot4_00001_20160227135436.pcapng
File type:           Wireshark/... - pcapng
File encapsulation:  Ethernet
Packet size limit:   file hdr: (not set)
Number of packets:   788 
File size:           1211 kB
Data size:           1184 kB
Capture duration:    9 seconds
Start time:          Sat Feb 27 13:54:36 2016
End time:            Sat Feb 27 13:54:46 2016
Data byte rate:      125 kBps
Data bit rate:       1001 kbps
Average packet size: 1503.41 bytes
Average packet rate: 83 packets/sec
SHA1:                c86ecff31377762d9c758da82f04fbbd46c2071d
RIPEMD160:           7b72ac2589890b7a9d90a2067aad62ac7c4775d5
MD5:                 0488d620ae35e04aecf88c608bf0cf8f
Strict time order:   True
两客户端都在下载时，统计到有线客户端实际下载速率1001000bps
两客户端都在下载时，有线客户端实际下载速率与限制的速率的差为181800bps
=============Statistics wired bandwith fifth time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:capinfos_all
File name:           D:/ftpcaps/ftp_wired_reboot5_00001_20160227135457.pcapng
File type:           Wireshark/... - pcapng
File encapsulation:  Ethernet
Packet size limit:   file hdr: (not set)
Number of packets:   793 
File size:           1225 kB
Data size:           1198 kB
Capture duration:    10 seconds
Start time:          Sat Feb 27 13:54:57 2016
End time:            Sat Feb 27 13:55:07 2016
Data byte rate:      125 kBps
Data bit rate:       1001 kbps
Average packet size: 1511.24 bytes
Average packet rate: 82 packets/sec
SHA1:                08d1d8a8ec36b295bcac5aad5f52d366e62f1a90
RIPEMD160:           a90aedc2513d2243c4c523ba284fb40bf8606b9e
MD5:                 589a71659c3631b0b134aca2546a0c6f
Strict time order:   True
两客户端都在下载时，统计到有线客户端实际下载速率1001000bps
两客户端都在下载时，有线客户端实际下载速率与限制的速率的差为181800bps
=============Statistics wired bandwith sixth time=================
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25->method_name:capinfos_all
File name:           D:/ftpcaps/ftp_wired_reboot6_00001_20160227135518.pcapng
File type:           Wireshark/... - pcapng
File encapsulation:  Ethernet
Packet size limit:   file hdr: (not set)
Number of packets:   834 
File size:           1285 kB
Data size:           1257 kB
Capture duration:    10 seconds
Start time:          Sat Feb 27 13:55:18 2016
End time:            Sat Feb 27 13:55:28 2016
Data byte rate:      125 kBps
Data bit rate:       1001 kbps
Average packet size: 1507.45 bytes
Average packet rate: 83 packets/sec
SHA1:                ac85573ae7e66768c78f2c21f1755e382dc2ad50
RIPEMD160:           daab92fc6cdbf8095c221df5a0fc2072780d5868
MD5:                 9dd50f2a74bc156685da77b42f7943b4
Strict time order:   True
两客户端都在下载时，统计到有线客户端实际下载速率1001000bps
两客户端都在下载时，有线客户端实际下载速率与限制的速率的差为181800bps
实际下载总速率为1320000
1 关闭下载和断开无线连接
2 删除QOS配置
[31mF[0m

[31mFinished tests in 692.641509s, 0.0014 tests/s, 0.0202 assertions/s.[0m


[31mFailure:
Frame::WebTestInternet#test_重启后QOS验证 ZLBF_27.1.25 [(eval):473]
Minitest::Assertion: 下载总流量与设置总带宽1024000不符[0m

[31m1 tests, 14 assertions, 1 failures, 0 errors, 0 skips[0m
Writing XML reports to E:/auto_sdk/frame/reports/20160227
