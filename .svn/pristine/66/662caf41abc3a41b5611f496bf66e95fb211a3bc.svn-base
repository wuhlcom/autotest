# pcap_t* pcap_open  ( const char *  source,
#                       int  snaplen,
#                       int  flags,
#                       int  read_timeout,
#                       struct pcap_rmtauth *  auth,
#                       char *  errbuf
# )

# int pcap_sendpacket  ( pcap_t *  p,
#                        u_char *  buf,
#                        int  size
#     )

require 'ffi'
module Wpcap
  extend FFI::Library
  ffi_lib('wpcap')
  # ffi_convention(:stdcall)
  attach_function(:open_nic, :pcap_open, [:pcap_t, :pointer, :int], :pcap_t)
  attach_function(:sendpacket, :pcap_sendpacket, [:pcap_t, :pointer, :int], :int)
end

'\\Device\\NPF_{C3FC08EA-71A1-4DE5-957F-4B9648D96562}'
devices = FFI::MemoryPointer.new(:pointer)
p Wpcap.sendpacket('\\Device\\NPF_{C3FC08EA-71A1-4DE5-957F-4B9648D96562}', devices, 255)
