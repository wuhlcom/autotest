#encoding:utf-8
#override the MiniTest::Unit::TestCase initialize method
#wuhongliang
require 'iam'
require 'rexml/document'
class IamTestNameSpace<MiniTest::Unit::TestCase
    extend IAMAPI::IamFrame
    include IAMAPI::Reporter

    def initialize name
        super name
        @iam_obj=IAMAPI::IAM.new
    end

    #设置按xml顺序来执行
    #重新定义test_order
    def self.test_order_xml!
        class << self
            undef_method :test_order if method_defined? :test_order
            define_method :test_order do
                :xml
            end
        end
    end

    #设置按xml顺序来执行
    #当test_order为:xml时按xml文件顺序来执行
    def self.runnable_methods
        methods = methods_matching(/^test_/)
        if self.test_order == :xml
            methods
        else
            super
        end
    end

    def operate(str="")
        puts "[#{Time.new.strftime('%Y-%m-%d %H:%M:%S')}] "+str.to_gbk
        yield
    end

    test_order_xml! #xml，按xml顺序执行
    # i_suck_and_my_tests_are_order_dependent! #alpha，按alpha顺序执行
end
